"""
    Questions
"""
1. Will it be better to implement PPO from scratch rather than initializing it from a stable-baselines3 library?
2. What hyperparameters improve the performance?
3. How many tries in average takes a trained model to complate a lap in the evaluation step?
4. Does a car trained in X circuit transfer equally to Y circuit in terms of performance? Or does it matter where is trained?
5. What does the literature say about model-free algorithms being capable of transfer learning? Only applies to model-based?
6. What kind of reward engineer improves the performance? Based on vision, or declaration of specific steering and velocity actions?
7. Why does it start by fast, and progressively slows down until reach a plateau around 58 mph (Fictional)?
8. Can I train a model on different circuits on the same step?


They start to accelerate on the second lap, and that causes some collisions.


"""
    Evaluation Runs
"""

    TRPO (Trained on Catalunya)

    AUSTIN 0 laps
    Per-Episode Rewards 
    [605.90451, 10671.868544, 1.88959, 19.264524, 20790.324017, 4529.813422, 5737.419552, 17508.632294, 11070.169443, -0.94439]
    [-2, 10528.857164, 10609.995245, 25363.240572, 31992.592375, 1.88959, 5338.379837, 4395.040344, 606.673129, 10569.238624]
    [6063.592044, 669.806136, 834.444555, 4413.124641, -2, 4373.354931, 10543.150364, 6067.658804, 10500.596268, 2.14636]
    
    Per-Episode Length (n_steps) (Around 3000 is one lap completed)
    [116, 1657, 8, 16, 3077, 702, 902, 2616, 1698, 4]
    [1, 1594, 1594, 3664, 4522, 8, 833, 670, 116, 1598]
    [941, 131, 155, 674, 1, 669, 1596, 947, 1595, 9]


    CATALUNYA 12/30 -> at least 1 lap completed & 1/4 of 2 laps completed
    Per-Episode Rewards
    [2248.969506, 42411.035708, 2224.0436, 2254.47521, 2170.571716, 4895.129525, 42448.99835, 22258.790393, 2231.014854, 22242.351018]
    [2064.418135, 2133.871597, 2255.607374, 2264.49451, 2209.909718, 26857.262179, 2076.135411, 42414.399132, 2216.424719, 42499.936]
    [4910.958054, 22195.868259, 2181.810096, 31993.826267, 25439.059226, 2262.399112, 2258.20456, 26855.647323, 2049.965403, 21501.621498]

    Per-Episode Length (n_steps) (5700 two laps, 2600 -> one lap)
    [363, 5737, 361, 364, 346, 749, 5736, 3197, 353, 3200]
    [332, 340, 355, 369, 352, 3501, 319, 5740, 347, 5745]
    [744, 3185, 338, 4432, 3603, 365, 369, 3519, 332, 2835]

    TRACK_1 4/30 laps completed
    Per-Episode Rewards (over 8600 is one lap)
    [7503.396588, 3555.004788, 5254.192557, 64.537229, 2855.803387, 42.096719, 34.623488, 7415.355404, 28.971437, 46.697009]
    [7462.104987, 7386.11559, 7532.888241, 12937.301831, 8635.609831, 7399.738854, 523.254364, 7515.345219, 7497.218586, 12860.259998]
    [6670.511431, 2851.300622, 6852.305588, 3542.098475, 2863.716431, 12726.577234, 7010.52456, 6864.767115, 7336.444091, 7339.055501]

    Per-Episode Length (n_steps) 
    [1145, 556, 802, 32, 444, 23, 25, 1141, 19, 24]
    [1138, 1145, 1134, 1900, 1362, 1161, 100, 1145, 1146, 1902]
    [1027, 437, 1056, 553, 433, 1875, 1069, 1050, 1156, 1156]

    TRACK_2 21/30 laps completed 73%
    Per-Episode Rewards
    [17936.539262, 6312.231535, 10518.601848, 6372.998524, 6546.086264, 6326.796329, 4780.888508, 17641.012383, 17710.623488, 10274.673348]
    [11559.016402, 11519.462131, 2867.114778, 17780.264664, 15694.657793, 15879.492504, 9438.153739, 15340.973104, 17595.068835, 10422.458657]
    [17751.850509, 6477.88005, 17437.432278, 17848.273306, 6552.55518, 11463.419386, 17842.975207, 17787.597576, 17841.928068, 3161.95598]

    Per-Episode Length (n_steps) (around 1350 is one lap)
    [2468, 972, 1410, 977, 1003, 963, 727, 2465, 2461, 1512]
    [1701, 1671, 458, 2474, 2197, 2223, 1425, 2154, 2483, 1526]
    [2462, 979, 2438, 2463, 1000, 1672, 2460, 2459, 2465, 513]


    PPO - 16 (Trained on Catalunya)
    Austin
    Per-Episode Rewards
    [-2, 648.80129, 4474.771678, 5507.611476, 4501.014038, 4459.039455, 25.288701, 609.720134, 4504.762477, 618.713338]
    [644.082056, 4535.660378, 661.404365, 4497.621825, 655.632451, 640.959983, 642.363894, -0.94439, 6249.038332, 4563.891348]
    [10721.776317, 6283.210592, 20.986011, 672.992235, 4486.048247, -0.94439, 678.821377, 10795.730576, 10914.596831, 6393.953895]

    Per-Episode Length (n_steps)
    [1, 116, 672, 827, 671, 674, 18, 109, 674, 110]
    [114, 675, 121, 697, 116, 116, 114, 4, 952, 682]
    [1612, 973, 20, 118, 679, 4, 120, 1619, 1642, 999]


    PPO - 11 (Track1)

    Austin
    Per-Episode Rewards
    [586.46742, 4495.364165, 10731.673771, 4536.570273, 684.576536, 4369.673724, 704.497973, 4463.627225, 596.651127, 6325.704058]
    [4487.158343, 34.876282, 4526.114582, 622.126355, 647.734895, 5515.025036, 4471.095488, 4401.126526, 4554.202874, 5458.14881]
    [4479.429138, 4541.661274, 4487.241937, 682.746635, 643.020208, 6214.422482, 638.740058, 10690.026159, 6262.74735, 4494.76118]
    

    Per-Episode Length (n_steps)
    [106, 679, 1633, 705, 121, 678, 123, 672, 113, 952]
    [684, 32, 687, 114, 121, 850, 672, 669, 703, 852]
    [674, 678, 687, 120, 116, 953, 119, 1609, 949, 679]


    PPO - 15 (Track2)

    Austin (0 laps completed absolute failure)
    Per-Episode Rewards
    [49.83901, 4498.947531, 581.772521, 4510.516004, 4523.185709, 4395.92692, 641.3723, 697.528889, 5553.364084, 4438.271172]
    [8.24227, 5562.072938, 17.49512, 629.866054, 622.066063, 5551.857145, 10859.095217, 647.981213, 4360.082379, 26.61559]
    [-0.94439, 4473.210903, 614.988557, 671.584815, 4452.4692, 682.227071, 4502.494942, 4507.083036, 4459.998102, 4439.367444]

    Per-Episode Length (n_steps) 
    [24, 687, 114, 684, 684, 676, 114, 124, 849, 687]
    [12, 857, 15, 119, 118, 839, 1643, 117, 679, 18]
    [4, 684, 121, 120, 682, 120, 685, 682, 677, 682]


    TRACK_2 (12/30 at least one lap completed on the trained circuit)
    Per-Episode Rewards (over 8600 is one lap)
    [16058.239762, 3073.133185, 11955.652644, 15808.500468, 3071.860198, 12114.09448, 15828.830412, 2869.686012, 3082.11436, 8405.07008]
    [2886.169131, 2863.010812, 8387.812179, 6427.251673, 2843.019493, 2878.426857, 2923.181676, 11987.235056, 2926.347764, 2893.706808]
    [2909.671197, 18462.809339, 2896.100509, 9322.719394, 2854.145515, 2857.018364, 2995.258966, 6340.019476, 18495.78864, 15855.350378]

    Per-Episode Length (n_steps) (around 1350 is one lap)
    [2210, 484, 1693, 2181, 485, 1731, 2184, 434, 497, 1239]
    [438, 433, 1243, 961, 437, 436, 445, 1694, 444, 441]
    [442, 2520, 438, 1364, 435, 433, 472, 941, 2543, 2182]

    TRACK_1 (Almost 12/30 laps completed, failure on last corner) 0/30 laps completed
    Per-Episode Rewards (over 8600 is one lap)
    [2302.318176, 6880.292817, 7784.104367, 6878.723379, 7761.135902, 17089.738975, 6973.708211, 7864.681344, 7889.578354, 2290.455017]
    [6864.943852, 6273.955009, 6920.718417, 6838.72032, 7756.241148, 2252.719568, 6794.610483, 6951.641773, 2241.391348, 6955.49029]
    [6180.73835, 7862.965745, 5385.45937, 6826.33269, 7868.040832, 6929.138736, 6990.563689, 6867.951145, 7789.13528, 6908.541391]

    Per-Episode Length (n_steps) 
    [355, 1024, 1167, 1021, 1158, 2379, 1038, 1171, 1176, 352]
    [1018, 936, 1025, 1022, 1153, 353, 1021, 1028, 344, 1031]
    [939, 1168, 808, 1017, 1191, 1028, 1036, 1029, 1152, 1029]

    CATALUNYA 11/30 laps completed at least
    Per-Episode Rewards (Around 20000 is one lap)
    [2317.006816, 24905.298578, 2314.261257, 2084.942943, 139.403248, 21630.100213, 21610.0063, 42824.272923, 2153.837388, 27027.503941]
    [24761.806198, 21668.717241, 21665.086314, 18810.830259, 2284.328207, 2112.908837, 2122.616074, 2101.575538, 21631.903641, 2133.692465]
    [42602.18926, 2136.38392, 21599.692825, 2132.112493, 2113.176076, 4.68553, 27078.673086, 2162.105781, 2115.139234, 2111.904365]
    
    Per-Episode Length (n_steps) (5700 two laps, 2600 -> one lap)
    [375, 3569, 397, 321, 55, 2848, 2861, 5795, 332, 3564]
    [3528, 2848, 2851, 2489, 370, 326, 328, 323, 2844, 329]
    [5773, 330, 2839, 329, 326, 10, 3529, 333, 326, 325]
    

Conclusion PPO15
Austin is hard, and does not even get close to completion
Track 1 could be achieved, maybe more training iterations, or shuffling the circuits for training. 0 completed, but failure on last corner.

Catalunya (0.37%) of at least one lap. (0.18% of those, completed 2 full laps)
Track 2 (Trained on it -> 0.40%)

Conclusion TRPO